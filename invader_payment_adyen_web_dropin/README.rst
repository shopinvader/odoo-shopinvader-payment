=================================
Invader Payment Adyen Web drop-in
=================================

.. 
   !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
   !! This file is generated by oca-gen-addon-readme !!
   !! changes will be overwritten.                   !!
   !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
   !! source digest: sha256:dedc3ab930c96f9f39f2dbbafcab3641d403bf4410f90f933097f11c5820983c
   !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

.. |badge1| image:: https://img.shields.io/badge/maturity-Beta-yellow.png
    :target: https://odoo-community.org/page/development-status
    :alt: Beta
.. |badge2| image:: https://img.shields.io/badge/licence-AGPL--3-blue.png
    :target: http://www.gnu.org/licenses/agpl-3.0-standalone.html
    :alt: License: AGPL-3
.. |badge3| image:: https://img.shields.io/badge/github-OCA%2Fodoo--shopinvader--payment-lightgray.png?logo=github
    :target: https://github.com/OCA/odoo-shopinvader-payment/tree/14.0/invader_payment_adyen_web_dropin
    :alt: OCA/odoo-shopinvader-payment
.. |badge4| image:: https://img.shields.io/badge/weblate-Translate%20me-F47D42.png
    :target: https://translation.odoo-community.org/projects/odoo-shopinvader-payment-14-0/odoo-shopinvader-payment-14-0-invader_payment_adyen_web_dropin
    :alt: Translate me on Weblate
.. |badge5| image:: https://img.shields.io/badge/runboat-Try%20me-875A7B.png
    :target: https://runboat.odoo-community.org/builds?repo=OCA/odoo-shopinvader-payment&target_branch=14.0
    :alt: Try me on Runboat

|badge1| |badge2| |badge3| |badge4| |badge5|

This module implements rest services for Adyen Web Drop-in payments.

**Table of contents**

.. contents::
   :local:

Configuration
=============

* Go to Invoicing > Payment Acquirers > Adyen Web Drop-in
* Add the Api key corresponding to the backend user

Usage
=====

This has been developed following `Adyen Web Drop-in documentation <https://docs.adyen.com/online-payments/build-your-integration/?platform=Web&integration=Drop-in&tab=python_6>`_.


Two services are exposed to manage payments with Adyen.

Here are the services (that can be explored and tested with Swagger):

* payments

    * This will initiate the payment session itself.

    * This takes as parameters:

        * target: (eg.: "current_cart")
        * The payable ID (invoice, SO,...)

    * Then a json is built internally to create a transaction (Odoo record) and send information to Adyen.

        .. code:: python

            def test_sessions_success(self):
                ady = Adyen.Adyen()
                client = ady.client
                client.xapikey = config.xapikey
                client.platform = "test"
                # Data build by the transaction
                request = {...}
                result = ady.checkout.sessions(request)
        ..

* webhook (also used as returnUrl after the payment)

    * This is used to update a transaction (Odoo record)

    * This takes as parameters:

        * transaction_id
        * data

    * Example of webhook json :

      .. code:: python

          {
            "live": "false",
            "notificationItems":[
              {
                "NotificationRequestItem":{
                  "eventCode":"AUTHORISATION",
                  "merchantAccountCode":"YOUR_MERCHANT_ACCOUNT",
                  "reason":"033899:1111:03/2030",
                  "amount":{
                    "currency":"EUR",
                    "value":2500
                  },
                  "operations":["CANCEL","CAPTURE","REFUND"],
                  "success":"true",
                  "paymentMethod":"mc",
                  "additionalData":{
                    "expiryDate":"03/2030",
                    "authCode":"033899",
                    "cardBin":"411111",
                    "cardSummary":"1111",
                    "checkoutSessionId":"xxx"
                  },
                  "merchantReference":"YOUR_REFERENCE",
                  "pspReference":"xxx",
                  "eventDate":"2021-09-13T14:10:22+02:00"
                }
              }
            ]
          }
      ..

Changelog
=========

- 12/2023 Module creation

Bug Tracker
===========

Bugs are tracked on `GitHub Issues <https://github.com/OCA/odoo-shopinvader-payment/issues>`_.
In case of trouble, please check there if your issue has already been reported.
If you spotted it first, help us to smash it by providing a detailed and welcomed
`feedback <https://github.com/OCA/odoo-shopinvader-payment/issues/new?body=module:%20invader_payment_adyen_web_dropin%0Aversion:%2014.0%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**>`_.

Do not contact contributors directly about support or help with technical issues.

Credits
=======

Authors
~~~~~~~

* ACSONE SA/NV

Contributors
~~~~~~~~~~~~

* François Honoré <francois.honore@acsone.eu>

Maintainers
~~~~~~~~~~~

This module is maintained by the OCA.

.. image:: https://odoo-community.org/logo.png
   :alt: Odoo Community Association
   :target: https://odoo-community.org

OCA, or the Odoo Community Association, is a nonprofit organization whose
mission is to support the collaborative development of Odoo features and
promote its widespread use.

This module is part of the `OCA/odoo-shopinvader-payment <https://github.com/OCA/odoo-shopinvader-payment/tree/14.0/invader_payment_adyen_web_dropin>`_ project on GitHub.

You are welcome to contribute. To learn how please visit https://odoo-community.org/page/Contribute.
